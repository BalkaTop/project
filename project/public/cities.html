
<!DOCTYPE html>
<html lang="en">
<head>
	<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BelGuessr - —É–≥–∞–¥–∞–π –≥–æ—Ä–æ–¥!</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            overflow: hidden;
            background-color: #f4f4f9;
        }
		#top-scores {
			position: relative;
			z-index: 10;  /* –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ z-index –±–æ–ª—å—à–µ, —á–µ–º —É –¥—Ä—É–≥–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
		}

		#score-list {
			position: relative;
			z-index: 10;  /* –¢–æ—Ç –∂–µ z-index –¥–ª—è —Å–ø–∏—Å–∫–∞ */
		}

#map-container {
    float: right;
    position: relative;
    top: 10px;
    right: 10px;
    width: 287px;   /* 70% –æ—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ 410px */
    height: 280px;  /* 70% –æ—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ 400px */
    border: 2px solid #000;
    border-radius: 8px;
    background-color: #fff;
    z-index: 2;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    transition: width 0.3s, height 0.3s;
}

/* Hover –¥–ª—è –∫–∞—Ä—Ç—ã, –ø–æ–∫–∞ –º–∞—Ä–∫–µ—Ä –Ω–µ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω */
#map-container.hoverable:hover {
    width: 533px;   /* 130% –æ—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ */
    height: 520px;  /* 130% –æ—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ */
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–Ω–æ–ø–æ–∫ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∫–∞—Ä—Ç–µ */
#button-container {
    position: absolute;
    top: calc(10px + 280px + 10px); /* –ø–æ–¥ –∫–∞—Ä—Ç–æ–π */
    right: 10px;
    z-index: 2;
    display: flex;            /* –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Ä—è–¥ */
    gap: 7px;                 /* —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∫–Ω–æ–ø–∫–∞–º–∏ */
    width: 287px;             /* –æ–±—â–∞—è —à–∏—Ä–∏–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ = —à–∏—Ä–∏–Ω–µ –∫–∞—Ä—Ç—ã */
    transition: top 0.3s, width 0.3s; /* –ø–ª–∞–≤–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã */
}

#button-container button {
    flex: 1;                  /* –∫–Ω–æ–ø–∫–∏ –¥–µ–ª—è—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ—Ä–æ–≤–Ω—É */
    padding: 10px 0;
    font-size: 14px;
    font-weight: bold;
    border-radius: 20px;
    border: none;
    cursor: pointer;
    background-color: #007bff;
    color: #fff;
    transition: background-color 0.3s, flex 0.3s; /* –ø–ª–∞–≤–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é flex */
}

#button-container button:hover {
    background-color: #66CDAA;
}

#leavebutton {
    position: absolute;
    top: calc(10px + 280px + 60px); /* —á—É—Ç—å –Ω–∏–∂–µ –ø–µ—Ä–≤–æ–π –∫–Ω–æ–ø–∫–∏ */
    right: 10px;
    z-index: 2;
    transition: top 0.3s, right 0.3s;
}

/* –ö–Ω–æ–ø–∫–∏ */
#calculate-distance, #leave {
    padding: 10px 20px;
    font-size: 16px;
    font-weight: bold;
    color: #fff;
    background-color: #007bff;
    border: none;
    border-radius: 30px;
    width: 270px;
    cursor: pointer;
}

#calculate-distance:hover, #leave:hover {
    background-color: #66CDAA;
}

        #popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 10;
            text-align: center;
        }

        #popup h2 {
            margin: 0 0 10px;
        }

        #popup button {
            padding: 10px 20px;
            font-size: 14px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
        }

        #popup button:hover {
            background-color: #66CDAA;
        }

        #overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 9;
        }

        #panorama {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
		}
       #markerPopup {
			display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 10;
            text-align: center;
		}
		#timeup{
			display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 10;
            text-align: center;}
		#timeup button{
			padding: 10px 20px;
            font-size: 14px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
		}
		#markerPopup button{
			padding: 10px 20px;
            font-size: 14px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
		}
		#markerPopup button:hover{
		background-color: #66CDAA;
		}
		#timeup button:hover{
		background-color: #66CDAA;
		}
		#timer {
		position: absolute;
		top: 20px;
		left: 20px;
		font-size: 24px;
		font-weight: bold;
		color: #fff;
		background-color: rgba(0, 0, 0, 0.7);
		padding: 10px 20px;
		border-radius: 10px;
		z-index: 10;
		}
		#timer {
		position: absolute;
		top: 20px;
		left: 20px;
		font-size: 24px;
		font-weight: bold;
		color: #fff;
		background-color: rgba(0, 0, 0, 0.7);
		padding: 10px 20px;
		border-radius: 10px;
		z-index: 10;
		}
		#leave{
			padding: 10px 20px;
            font-size: 16px;
            font-weight: bold;
            color: #fff;
            background-color: #007bff;
            border: none;
            border-radius: 30px;
            width: 270px;
            cursor: pointer;
			z-index:10
			}
		#leavebutton{
			position: absolute;
			right:75px;;
			top:490px;
            
           
            z-index: 2;}
		#leave:hover{
			background-color: #66CDAA;
		‚Ññtop-scores{
			position:fixed;
			left:200px;}
		
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBGbr_QILBhKjlGn5KywwhRM4qZEYR3vXk&libraries=geometry"></script>
</head>
<body>
	
	
    <div id="map-container"></div>
<div id="button-container">
    <button id="calculate-distance">Guess!</button>
    <button id="leave" onclick="window.location.href='index.html'">–í—ã–π—Ç–∏</button>
</div>
    <div id="panorama"></div>

    <div id="popup">
        <h2>–ö–æ–ª-–≤–æ –æ—á–∫–æ–≤: <span id="score"></span></h2>
        <p>–õ–æ–∫–∞—Ü–∏—è: <span id="location-name"></span>.</p>
		<p>–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: <span id = 'distanceInKm'></span>–∫–º.</p>
		<div id="top-scores">
		<h3>–¢–æ–ø-5 —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</h3>
		<div id="score-list">
        
		</div>
		</div>
        <button onclick="closePopup()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
	<div id = 'markerPopup'>
		<p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –º–∞—Ä–∫–µ—Ä –Ω–∞ –∫–∞—Ä—Ç–µ</p>
		<button onclick = 'closeMarkerPopup()'>–ó–∞–∫—Ä—ã—Ç—å</button>
	</div>
	<div id = 'timeup'>
		<h2>–í—Ä–µ–º—è –≤—ã—à–ª–æ!<h2>
		<h2>–ö–æ–ª-–≤–æ –æ—á–∫–æ–≤:<span id = 'score'></span></h2>
		<p>–õ–æ–∫–∞—Ü–∏—è: <span id="location-name"></span>.</p>
		<p>–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: <span id = 'distanceInKm'></span>–∫–º.</p>
		<button onclick="closePopup()">–ó–∞–∫—Ä—ã—Ç—å</button>
	</div>
	
	<div id = 'timer'>30</div>
    <div id="overlay"></div>
    <script>
        let panorama, map, marker;
		let realMarker = null;           // –ú–∞—Ä–∫–µ—Ä —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª–æ–∂–µ–Ω–∏—è –ø–∞–Ω–æ—Ä–∞–º—ã
		let lineBetween = null;          // –õ–∏–Ω–∏—è –º–µ–∂–¥—É –º–∞—Ä–∫–µ—Ä–∞–º–∏
        let panoramaLocation;
		let timeLeft = 30; // –í—Ä–µ–º—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
		let timerInterval;
        const knownLocations = [
            { lat: 53.88042,   lng: 27.4855477, name: '–ú–∏–Ω—Å–∫' },
            { lat: 53.6676981, lng: 23.9069996, name: '–ì—Ä–æ–¥–Ω–æ' }, 
            { lat: 52.0805018, lng: 23.7169662, name: '–ë—Ä–µ—Å—Ç' },
            { lat: 52.4317027, lng: 30.9938685, name: '–ì–æ–º–µ–ª—å' },
            { lat: 53.8980519, lng: 30.3340392, name: '–ú–æ–≥–∏–ª—ë–≤' },
            { lat: 55.1924057, lng: 30.2067509, name: '–í–∏—Ç–µ–±—Å–∫' },
            { lat: 55.4846103, lng: 28.7775038, name: '–ü–æ–ª–æ—Ü–∫' },
            { lat: 54.1010124, lng: 28.3285245, name: '–ñ–æ–¥–∏–Ω–æ' },
            { lat: 52.8163544, lng: 27.5591826, name: '–°–æ–ª–∏–≥–æ—Ä—Å–∫' },
            { lat: 53.1319188, lng: 26.019032, name: '–ë–∞—Ä–∞–Ω–æ–≤–∏—á–∏' },
            { lat: 53.024559,  lng: 27.5551262, name: '–°–ª—É—Ü–∫' },
            { lat: 53.0655604, lng: 26.6419315, name: '–ö–ª–µ—Ü–∫' },
            { lat: 53.2225454, lng: 26.6887444, name: '–ù–µ—Å–≤–∏–∂' },
            { lat: 53.142776, lng:  29.222351, name: '–ë–æ–±—Ä—É–π—Å–∫' },
            { lat: 53.0823829, lng:30.0537977, name: '–†–æ–≥–∞—á–µ–≤' },
			{ lat: 53.1524453, lng: 27.0908226, name: '–ö–æ–ø—ã–ª—å' }
        ];
	
        function getRandomLocation() {
            const randomIndex = Math.floor(Math.random() * knownLocations.length);
            return knownLocations[randomIndex];
        }
		

		function startTimer() {
		    clearInterval(timerInterval); // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
			document.getElementById("timer").textContent = timeLeft;
			timerInterval = setInterval(() => {
				if (timeLeft > 0) {
					timeLeft--;
					document.getElementById("timer").textContent = timeLeft;
				} else {
					clearInterval(timerInterval);
					TimeUp();
				}
			}, 1000);
		}
		function stopTimer() {
			clearInterval(timerInterval);
		}
        function initPanorama() {
            const randomLocation = getRandomLocation();
            panoramaLocation = randomLocation;
            if (panorama) {
                panorama.setPosition(randomLocation);
            } else {
                panorama = new google.maps.StreetViewPanorama(
                    document.getElementById("panorama"),
                    {
                        position: randomLocation,
                        pov: {
                            heading: 34,
                            pitch: 10,
                        },
                        zoom: 1,
                        disableDefaultUI: true,
                        addressControl: false,
                    }
                );
            }
			 updateScoreboard(randomLocation.name);
        }
		
		
function initMap() {
    map = new google.maps.Map(document.getElementById("map-container"), {
        center: { lat: 53.9008985, lng: 27.5717368 },
        zoom: 5,
    });

    // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∏–∫ **—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã**
    map.addListener("click", (event) => {
        if (marker) marker.setMap(null);
        marker = new google.maps.Marker({
            position: event.latLng,
            map: map,
        });

        // —Ñ–∏–∫—Å–∏—Ä—É–µ–º –±–æ–ª—å—à–æ–π —Ä–∞–∑–º–µ—Ä –∫–∞—Ä—Ç—ã
        markerPlaced = true;
        mapContainer.style.width = "533px";
        mapContainer.style.height = "520px";
        buttonContainer.style.top = "540px";
        leaveButton.style.top = "610px";

        // –£–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å hoverable, —á—Ç–æ–±—ã –±–æ–ª—å—à–µ –Ω–µ —É–º–µ–Ω—å—à–∞—Ç—å –∫–∞—Ä—Ç—É
        mapContainer.classList.remove("hoverable");
    });
}

function calculateDistance() {
    if (!marker) {
        OpenMarkerPopup();
        return;
    }

    const markerPosition = marker.getPosition();
    const distance = google.maps.geometry.spherical.computeDistanceBetween(
        new google.maps.LatLng(panoramaLocation),
        markerPosition
    ) / 1000;

    const distanceInKm = distance.toFixed(2);

    const maxDistance = 20000;
    const score = Math.max(0, 5000 * (1 - Math.log(distance + 1) / Math.log(maxDistance + 1)));

    document.getElementById("score").innerText = Math.round(score);
    document.getElementById("location-name").innerText = panoramaLocation.name;
    document.getElementById("distanceInKm").innerText = distanceInKm;

    saveScore(score);
    stopTimer();

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é, –∞ –ø–æ–ø–∞–ø –≤—ã–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –Ω–µ—ë
    showRealLocation(() => {
        openPopup();
    });
}



		
		function TimeUp() {
			document.getElementById('timeup').style.display = 'block';
			document.getElementById('overlay').style.display = 'block';

			document.querySelector("#timeup #score").innerText = "0";
			document.querySelector("#timeup #location-name").innerText = panoramaLocation.name;
			document.querySelector("#timeup #distanceInKm").innerText = "‚àû"; // –ò–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º
		}
        function openPopup() {
            document.getElementById("popup").style.display = "block";
            document.getElementById("overlay").style.display = "block";
        }
		function OpenMarkerPopup(){
			document.getElementById('markerPopup').style.display = 'block';
			document.getElementById('overlay').style.display = 'block';
		}
			
function closePopup() {
    document.getElementById("popup").style.display = "none";
    document.getElementById("overlay").style.display = "none";
    document.getElementById('timeup').style.display = 'none';

    resetMap();          // —Å–±—Ä–æ—Å –∫–∞—Ä—Ç—ã –∏ –º–∞—Ä–∫–µ—Ä–æ–≤
    clearInterval(timerInterval);

    timeLeft = 30;
    startTimer();        // –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä –∑–∞–Ω–æ–≤–æ

    initPanorama();      // –∑–∞–≥—Ä—É–∂–∞–µ–º –Ω–æ–≤—É—é –ø–∞–Ω–æ—Ä–∞–º—É

    // üîπ —Å–±—Ä–æ—Å —Ä–∞–∑–º–µ—Ä–∞ –∫–∞—Ä—Ç—ã –∏ hover
    markerPlaced = false;
    mapContainer.classList.add("hoverable");
    mapContainer.style.width = "287px";
    mapContainer.style.height = "280px";
    buttonContainer.style.top = "300px";
    leaveButton.style.top = "370px";
}


		function closeMarkerPopup(){
			document.getElementById('markerPopup').style.display = 'none';
			document.getElementById('overlay').style.display = 'none'
		}
function resetMap() {
    // –£–¥–∞–ª—è–µ–º –∏–≥—Ä–æ–≤–æ–π –º–∞—Ä–∫–µ—Ä
    if (marker) {
        marker.setMap(null);
        marker = null;
    }

    // –£–¥–∞–ª—è–µ–º –º–∞—Ä–∫–µ—Ä —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–µ—Å—Ç–∞
    if (realMarker) {
        realMarker.setMap(null);
        realMarker = null;
    }

    // –£–¥–∞–ª—è–µ–º –ª–∏–Ω–∏—é
    if (lineBetween) {
        lineBetween.setMap(null);
        lineBetween = null;
    }

    // üî• –í–û–ó–í–†–ê–©–ê–ï–ú –∫–∞—Ä—Ç—É –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
    map.setCenter({ lat: 53.9008985, lng: 27.5717368 }); // —Ü–µ–Ω—Ç—Ä –ë–µ–ª–∞—Ä—É—Å–∏ / –ú–∏–Ω—Å–∫–∞
    map.setZoom(5);                                       // —Ç–≤–æ–π –∏—Å—Ö–æ–¥–Ω—ã–π –∑—É–º
}




        document.getElementById("calculate-distance").addEventListener("click", calculateDistance);
		function saveScore(score) {
			const locationKey = panoramaLocation.name; // –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –ø–∞–Ω–æ—Ä–∞–º—ã
			let scores = JSON.parse(localStorage.getItem("scores")) || {};

			if (!scores[locationKey]) {
				scores[locationKey] = [];
			}

			scores[locationKey].push(Math.round(score));
			scores[locationKey].sort((a, b) => b - a); // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é
			scores[locationKey] = scores[locationKey].slice(0, 5); // –û—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Ç–æ–ø-5

			localStorage.setItem("scores", JSON.stringify(scores));

			updateScoreboard(locationKey);
		}

		function updateScoreboard(locationKey) {
			const scores = JSON.parse(localStorage.getItem("scores")) || {};
			const scoreList = document.getElementById("score-list");

			scoreList.innerHTML = ""; // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫

			if (scores[locationKey]) {
				scores[locationKey].forEach((score, index) => {
				 	let listItem = document.createElement("div");
					listItem.textContent = `${index + 1}. ${score} –æ—á–∫–æ–≤`;
				 	scoreList.appendChild(listItem);
				});
			} else {
				scoreList.innerHTML = "<li>–ù–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</li>";
			}
		}

		function displayTopScores() {
			const topScores = JSON.parse(localStorage.getItem('topScores')) || [];
			const scoreList = document.getElementById("score-list");
			scoreList.innerHTML = '';

    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–ø–∏—Å–∫–µ —Å –æ–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–º–∏ –æ—á–∫–∞–º–∏
			topScores.forEach((player, index) => {
				const listItem = document.createElement("li");
				listItem.textContent = `${index + 1}. ${player.name}: ${player.score} points`;
				scoreList.appendChild(listItem);
		});
	}	


function showRealLocation(callback) {
    if (realMarker) realMarker.setMap(null);
    if (lineBetween) lineBetween.setMap(null);

    const playerPos = marker.getPosition();
    const realPos = new google.maps.LatLng(panoramaLocation);

    // –ü–∞–Ω–æ—Ä–∞–º–∏—Ä—É–µ–º –∫ —Å–µ—Ä–µ–¥–∏–Ω–µ
    const midLat = (playerPos.lat() + realPos.lat()) / 2;
    const midLng = (playerPos.lng() + realPos.lng()) / 2;
    const midPoint = new google.maps.LatLng(midLat, midLng);
    map.panTo(midPoint);

    // –ü–æ–¥–≥–æ–Ω—è–µ–º –∑—É–º –ø–æ–¥ –æ–±–∞ –º–∞—Ä–∫–µ—Ä–∞
    setTimeout(() => {
        const bounds = new google.maps.LatLngBounds();
        bounds.extend(playerPos);
        bounds.extend(realPos);
        map.fitBounds(bounds, {
    top: 50,
    bottom: 50,
    left: 50,
    right: 50
});
    }, 400);

    // –°—Ç–∞–≤–∏–º –∑–µ–ª—ë–Ω—ã–π –º–∞—Ä–∫–µ—Ä
    setTimeout(() => {
        realMarker = new google.maps.Marker({
            position: realPos,
            map: map,
            animation: google.maps.Animation.DROP,
            icon: { url: "http://maps.google.com/mapfiles/ms/icons/green-dot.png" }
        });
    }, 900);

    // –ê–Ω–∏–º–∏—Ä—É–µ–º –ª–∏–Ω–∏—é
    setTimeout(() => {
        const path = [playerPos, playerPos];
        lineBetween = new google.maps.Polyline({
            path: path,
            geodesic: true,
            strokeColor: "#FF0000",
            strokeOpacity: 1.0,
            strokeWeight: 3,
            map: map
        });

        const duration = 800;
        const step = 20;
        let progress = 0;

        const interval = setInterval(() => {
            progress += step;
            const ratio = Math.min(progress / duration, 1);

            const lat = playerPos.lat() + (realPos.lat() - playerPos.lat()) * ratio;
            const lng = playerPos.lng() + (realPos.lng() - playerPos.lng()) * ratio;

            lineBetween.setPath([
                playerPos,
                { lat, lng }
            ]);

            if (ratio >= 1) {
                clearInterval(interval);
                if (callback) callback(); // <-- –≤—ã–∑—ã–≤–∞–µ–º –∫–æ–ª–ª–±–µ–∫ –≤ –∫–æ–Ω—Ü–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            }
        }, step);
    }, 1400);
}







        window.onload = function () {
            initPanorama();
            initMap();
			const mapContainer = document.getElementById("map-container");

mapContainer.addEventListener("mouseenter", () => {
    setTimeout(() => {
        google.maps.event.trigger(map, "resize");
    }, 310); // —á—É—Ç—å –±–æ–ª—å—à–µ, —á–µ–º transition
});

mapContainer.addEventListener("mouseleave", () => {
    setTimeout(() => {
        google.maps.event.trigger(map, "resize");
    }, 310);
});
			
			
			startTimer();
			
		
        };
		
		
		const mapContainer = document.getElementById("map-container");
const buttonContainer = document.getElementById("button-container");
const leaveButton = document.getElementById("leavebutton");
let markerPlaced = false;

// –ö–ª–∞—Å—Å hoverable –¥–æ–±–∞–≤–ª—è–µ–º, —á—Ç–æ–±—ã hover —Ä–∞–±–æ—Ç–∞–ª —Ç–æ–ª—å–∫–æ –¥–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –º–∞—Ä–∫–µ—Ä–∞
mapContainer.classList.add("hoverable");

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ hover
mapContainer.addEventListener("mouseenter", () => {
    if (!markerPlaced) {
        mapContainer.style.width = "533px";
        mapContainer.style.height = "520px";

    }
});
mapContainer.addEventListener("mouseleave", () => {
    if (!markerPlaced) {
        mapContainer.style.width = "287px";
        mapContainer.style.height = "280px";
        buttonContainer.style.top = "300px";
        leaveButton.style.top = "370px";
    }
});


mapContainer.addEventListener("mouseenter", () => {
    if (!markerPlaced) {
	        buttonContainer.style.top = "540px";
        leaveButton.style.top = "610px";
        mapContainer.style.width = "533px";
        mapContainer.style.height = "520px";
    }
});
mapContainer.addEventListener("mouseleave", () => {
    if (!markerPlaced) {
        mapContainer.style.width = "287px";
        mapContainer.style.height = "280px";
    }
});

    </script>
</body>
</html>

